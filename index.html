<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <title>SISTEMA MAX - Intelig√™ncia e Resposta</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; background: #0b0f19; color: white; display: flex; height: 100vh; overflow: hidden; }
        
        #sidebar { width: 380px; background: #111827; display: flex; flex-direction: column; border-right: 2px solid #1f2937; z-index: 1000; }
        
        /* Abas Invertidas: Den√∫ncia primeiro */
        .tabs { display: flex; background: #1f2937; }
        .tab { flex: 1; padding: 15px; text-align: center; cursor: pointer; font-weight: bold; font-size: 0.75rem; color: #64748b; border-bottom: 3px solid transparent; }
        .tab.active { background: #111827; color: #3b82f6; border-bottom: 3px solid #3b82f6; }
        .tab-emergency.active { color: #ef4444; border-bottom: 3px solid #ef4444; }

        .content-area { padding: 20px; flex-grow: 1; overflow-y: auto; }
        .tab-content { display: none; }
        .tab-content.active { display: block; }

        /* Estilos de Den√∫ncia */
        .form-group { margin-bottom: 15px; padding: 12px; background: #1e293b; border-radius: 8px; border: 1px solid #334155; }
        label { display: block; margin-bottom: 8px; font-size: 0.7rem; color: #3b82f6; font-weight: bold; text-transform: uppercase; }
        select, textarea, input { width: 100%; padding: 10px; border-radius: 6px; border: 1px solid #374151; background: #0f172a; color: white; outline: none; }

        /* Estilos de Socorro */
        .panic-box { background: #2d0a0a; border: 2px solid #ef4444; padding: 20px; border-radius: 12px; text-align: center; }
        .panic-btn { background: #ef4444; color: white; border: none; padding: 20px; border-radius: 8px; width: 100%; font-size: 1.2rem; font-weight: bold; cursor: pointer; margin-bottom: 15px; box-shadow: 0 0 15px rgba(239, 68, 68, 0.4); }
        .call-btn { background: #991b1b; color: white; text-decoration: none; display: flex; align-items: center; justify-content: center; padding: 15px; border-radius: 8px; font-weight: bold; margin-bottom: 10px; border: 1px solid #f87171; }
        
        .clean-btn { background: #1e293b; color: #94a3b8; border: none; padding: 12px; width: 100%; font-size: 0.7rem; font-weight: bold; cursor: pointer; margin-top: auto; border-top: 1px solid #334155; }
        .clean-btn:hover { background: #334155; color: white; }
    </style>
</head>
<body>

    <div id="sidebar">
        <div class="tabs">
            <div class="tab active" onclick="switchTab('report', this)">üìù DEN√öNCIA</div>
            <div class="tab tab-emergency" onclick="switchTab('emergency', this)">üö® SOCORRO</div>
        </div>

        <div class="content-area">
            <div id="report" class="tab-content active">
                <div style="text-align: center; margin-bottom: 15px;">
                    <span style="background: #1e3a8a; color: #93c5fd; font-size: 0.6rem; padding: 3px 8px; border-radius: 4px; font-weight: bold;">INTELIG√äNCIA SIGILOSA</span>
                </div>
                
                <div class="form-group">
                    <label>Local da Ocorr√™ncia</label>
                    <button onclick="marcarRaioSigilo()" style="width:100%; padding:12px; background:#064e3b; color:#10b981; border:1px solid #10b981; border-radius:6px; font-weight:bold; cursor:pointer; margin-bottom:10px;">üéØ MARCAR MINHA REGI√ÉO (150m)</button>
                    <input type="text" id="endereco" placeholder="Ou digite o logradouro">
                </div>

                <div class="form-group">
                    <label>Tipo de Crime</label>
                    <select id="tipo">
                        <option>Tr√°fico de Drogas</option>
                        <option>Corrup√ß√£o / Suborno</option>
                        <option>Roubo de Ve√≠culos</option>
                        <option>Agress√£o (Animais/Idosos/Mulheres)</option>
                    </select>
                </div>

                <div class="form-group">
                    <label>Relato Detalhado</label>
                    <textarea id="desc" rows="4" placeholder="Descreva o que est√° acontecendo..."></textarea>
                </div>

                <button onclick="alert('Protocolo de Den√∫ncia Enviado!')" style="width:100%; padding:18px; background:#3b82f6; color:white; border:none; border-radius:8px; font-weight:bold; cursor:pointer; font-size: 1rem;">ENVIAR DEN√öNCIA</button>
            </div>

            <div id="emergency" class="tab-content">
                <div style="text-align: center; margin-bottom: 15px;">
                    <span style="background: #ef4444; color: white; font-size: 0.6rem; padding: 3px 8px; border-radius: 4px; font-weight: bold;">CANAL DIRETO COPOM</span>
                </div>

                <div class="panic-box">
                    <button class="panic-btn" onclick="acionarProtocoloTotal()">üÜò BOT√ÉO DE P√ÇNICO</button>
                    <a href="tel:190" class="call-btn">üìû LIGAR 190 (OCULTO)</a>
                    <p style="font-size: 0.65rem; color: #f87171; margin-top: 5px;">Rastreamento e Escuta Ativos ap√≥s o clique.</p>
                </div>

                <div class="form-group" style="margin-top: 15px;">
                    <label>Emerg√™ncia Cr√≠tica</label>
                    <select>
                        <option>Agress√£o em Curso</option>
                        <option>Invas√£o de Domic√≠lio</option>
                        <option>Risco de Vida Imediato</option>
                    </select>
                </div>
            </div>
        </div>
        
        <button class="clean-btn" onclick="limpezaTotal()">‚ö†Ô∏è LIMPAR EVID√äNCIAS E SAIR</button>
    </div>

    <div id="map"></div>

    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        var map = L.map('map', { zoomControl: false }).setView([-15.78, -47.92], 4);
        L.tileLayer('https://{s}.basemaps.cartocdn.com/dark_all/{z}/{x}/{y}{r}.png').addTo(map);

        let markerEme = null;
        let circleSigilo = null;

        function switchTab(tabId, el) {
            document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
            document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
            document.getElementById(tabId).classList.add('active');
            el.classList.add('active');
        }

        function acionarProtocoloTotal() {
            alert("PROTOCOLO DE CRISE: Localiza√ß√£o em tempo real e microfone ativados.");
            navigator.geolocation.watchPosition((pos) => {
                const { latitude, longitude } = pos.coords;
                if(markerEme) map.removeLayer(markerEme);
                map.flyTo([latitude, longitude], 18);
                markerEme = L.marker([latitude, longitude]).addTo(map).bindPopup("<b>ALVO MONITORADO</b>").openPopup();
            }, null, { enableHighAccuracy: true });
            
            // Ativa microfone (escuta)
            navigator.mediaDevices.getUserMedia({ audio: true }).catch(() => {});
        }

        function marcarRaioSigilo() {
            navigator.geolocation.getCurrentPosition((pos) => {
                const { latitude, longitude } = pos.coords;
                if(circleSigilo) map.removeLayer(circleSigilo);
                map.flyTo([latitude, longitude], 17);
                circleSigilo = L.circle([latitude, longitude], { color: '#3b82f6', radius: 150 }).addTo(map);
                document.getElementById('endereco').value = "COORDENADAS PROTEGIDAS (150m)";
            });
        }

        function limpezaTotal() {
            if(confirm("Deseja apagar os rastros desta sess√£o?")) {
                window.location.href = "https://www.google.com";
            }
        }
    </script>
</body>
</html>