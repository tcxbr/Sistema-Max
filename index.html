<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SISTEMA MAX - Dispositivo TÃ¡tico</title>
    <style>
        * { box-sizing: border-box; }
        body { margin: 0; padding: 0; font-family: 'Segoe UI', sans-serif; background: #0b0f19; color: white; display: flex; flex-direction: column; height: 100vh; overflow: hidden; }
        .tabs { display: flex; background: #1f2937; }
        .tab { flex: 1; padding: 20px; text-align: center; cursor: pointer; font-weight: bold; font-size: 0.9rem; color: #64748b; border-bottom: 3px solid transparent; }
        .tab.active { background: #111827; color: #ef4444; border-bottom: 3px solid #ef4444; }
        .content-area { padding: 30px; flex-grow: 1; display: flex; flex-direction: column; justify-content: center; }
        .panic-box { background: #2d0a0a; border: 2px solid #ef4444; padding: 40px 20px; border-radius: 20px; text-align: center; box-shadow: 0 0 30px rgba(239, 68, 68, 0.2); }
        .panic-btn { background: #ef4444; color: white; border: none; padding: 30px; border-radius: 50%; width: 160px; height: 160px; font-size: 1.5rem; font-weight: bold; cursor: pointer; box-shadow: 0 0 25px rgba(239, 68, 68, 0.5); transition: transform 0.1s; }
        .panic-btn:active { transform: scale(0.95); background: #991b1b; }
        #status-gps { font-size: 0.8rem; color: #94a3b8; margin-top: 20px; display: block; text-transform: uppercase; letter-spacing: 1px; }
    </style>
</head>
<body>

    <div class="tabs">
        <div class="tab active">ðŸš¨ BOTÃƒO DE PÃ‚NICO</div>
    </div>

    <div class="content-area">
        <div class="panic-box">
            <button class="panic-btn" onclick="acionarProtocoloTotal()">SOS</button>
            <span id="status-gps">SISTEMA PRONTO</span>
        </div>
    </div>

    <script src="https://cdn.ably.com/lib/ably.min-1.js"></script>
    <script>
        const ably = new Ably.Realtime('nIelyg.53cnCw:XImw8D79XEvpS3D-o-satgyzgvrpKtNfhrcLFyIuvgM'); 
        const canal = ably.channels.get('monitoramento');

        function acionarProtocoloTotal() {
            const status = document.getElementById('status-gps');
            status.innerText = "CAPTURANDO GPS...";
            status.style.color = "#fbbf24";

            if (navigator.vibrate) navigator.vibrate(100);

            navigator.geolocation.getCurrentPosition((pos) => {
                const { latitude, longitude } = pos.coords;
                
                canal.publish('emergencia', { 
                    msg: 'ðŸš¨ PÃ‚NICO ATIVADO', 
                    lat: latitude, 
                    lng: longitude 
                });

                status.innerText = "SINAL ENVIADO!";
                status.style.color = "#10b981";
            }, (err) => {
                canal.publish('emergencia', { msg: 'ðŸš¨ PÃ‚NICO (SEM GPS)' });
                status.innerText = "ENVIADO SEM LOCALIZAÃ‡ÃƒO";
                status.style.color = "#ef4444";
            }, { 
                enableHighAccuracy: true, 
                timeout: 8000, 
                maximumAge: 0 
            });
        }
    </script>
</body>
</html>